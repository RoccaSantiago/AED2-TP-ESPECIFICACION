\documentclass[10pt,a4paper]{article}

\input{AEDmacros}
\usepackage{caratula} % Version modificada para usar las macros de algo1 de ~> https://github.com/bcardiff/dc-tex


\titulo{Trabajo pr\'actico 1: Especificac\'ion y WP}
\subtitulo{Elecciones Nacionales}

\fecha{\today}

\materia{Algoritmos y Estructuras de Datos}
\grupo{sudo\_rm-rf\_/*}

\integrante{Rocca, Santiago}{152/23}{santiagrocca17@gmail.com}
\integrante{Fisz, Maximiliano}{586/19}{maximilianofisz@gmail.com}   
\integrante{Gomez, Abril}{574/20}{goskema@gmail.com}
\integrante{L\'opez, Gonzalo}{1017/22}{gonzalo.esloga.uba@gmail.com}
% Pongan cuantos integrantes quieran

% Declaramos donde van a estar las figuras
% No es obligatorio, pero suele ser comodo
\graphicspath{{../static/}}

\begin{document}

\maketitle

\section{Especificaci\'on}
	

    \subsection{General}


	\subsubsection{Predicados Universales}
		
		\pred{noHayRepetidos}{\In escrutinio : \TLista{\ent}}{(\forall x: \ent)(0 \leq x < |escrutinio| \: \longrightarrow_{L} \: ((\forall y: \ent)(0 \leq y < |escrutinio| \: \land  \: \neg(x=y) \: \longrightarrow_{L }\neg(escrutinio[x] = escrutinio[y])))}
		
		\pred{cantVotosValidos}{\In escrutinio : \TLista{\ent}}{((\forall x: \ent)(0 \leq x < |escrutinio|) \: \longrightarrow_{L } (escrutinio[x] \geq 0))}
	
		\pred{escrutinioValdio}{\In escrutinio: \TLista{\ent}}{|escrutinio| \geq 2}
		
		\pred{EleccionValida}{\In escrutinio: \TLista{\ent}}{nohayRepetidos(escrutinio) \land cantVotosValidos(escrutinio) \land escrutinioValido(escrutinio)}
		
		\pred{umbralElectoral}{\In escrutinioSen : \TLista{\ent}}{((\forall x: \ent)(0 \leq x < |escrutinio|) \: \longrightarrow_{L } (escrutinioSen[x] > 3))}

        \pred{minimoDePartidos}{\In escrutinio: \TLista{\ent}}{|escrutinio| \geq 3}


    \subsubsection{Auxiliares}

		\aux{sumaDeVotos}{\In escrutinio : \TLista{\ent}}{\ent}{\sum\limits_{i=0}^{|escrutinio| - 1} escrutinio[i]}

		\aux{porcentajeDeVotos}{\In escrutinio: \TLista{\ent}, \In votosPartido: \ent}{\float}{sumaDeVotos(escrutinio)^{-1} \; * \; votosPartido \; * \; 10^{2})}

		\aux{bancasDe}{\In indicePartido: \ent, \In bancas, \In dHont  \TLista{\TLista{\ent}}}{\ent}{ \\ \sum\limits_{p=0}^{bancas - 1} if \: cocienteGanador(indicePartido, p, dHont) \: then \: 1 \:  else \: 0}
	


\subsection{hayBallotage}
		\subsubsection{Main}

			\begin{proc}{hayBallotage}{\In escrutinio : \TLista{\ent}}{\bool}
	
				\requiere{eleccionValida(escrutinio))}
	
				\asegura{res=\neg((partidoMayorA45\%(escrutinio))\lor (partidoMayorA40\%ConDiferencia(escrutinio)))}

			\end{proc}

		\subsubsection{Predicados Especificos}

			\pred{partidoMayorA45\%}{\In escrutinio : \TLista{\ent}}{(\exists n:\ent)(0 \leq n < |escrutinio|-1 \land_{ L }(porcentajeDeVotos(escrutinio,escrutinio[n])>45)}


			\pred{partidoMayorA40\%ConDiferencia}{\In escrutinio : \TLista{\ent}}{(\exists n:\ent)(0 \leq n < |escrutinio| -1 \land_{ L }(porcentajeDeVotos(escrutinio,escrutinio[n])>40) \: \land_{ L } \\ \neg(\forall x:\ent)(0\leq x < |escrutinio|-1 \land  (\neg(n=x) \longrightarrow_{ L } ((escrutinio[n] - escrutinio[x])>10)) }


			


\subsection{hayFraude}
		\subsubsection{Main}
			
			\begin{proc}{hayFraude}{(\In escrutinio\_Presidente: \TLista{\ent}, \In escrutinio\_Senadores: \TLista{\ent}‚ü©, \In escrutinio\_Diputados: \TLista{\ent}}{\bool}
				\requiere{umbralElectoral(escrutinio\_Senadores)\: \land\:eleccionValida(escrutinio\_Presidente) \: \land\:\\ eleccionValida(escrutinio\_Senadores) \: \land \: eleccionValida(escrutinio\_diputados) \land \\ minimoDePartidos(escrutinio\_Senadores) \land \\ 
(|escrutinio\_Presidente| = |escrutinio\_Senadores| = |escrutinio\_Diputados|)}
				
				\asegura{res=\neg(((|sumaDeVotos(escrutinio\_Presidente) = sumaDeVotos(escrutinio\_Senadores)) \land \\ (sumaDeVotos(escrutinio\_Presidente) = sumaDeVotos(escrutinio\_Diputados)))}
			
			\end{proc}






		
	\subsection{obtenerSenadoresEnProvincia}
		\subsubsection{Main}
			
			\begin{proc}{obtenerSenadoresEnProvincia}{\In escrutinio : \TLista{\ent}}{\ent \texttimes \ent}

                			\requiere{eleccionValida(escrutinio) \land minimoDePartidos(escrutinio)}
                			\asegura{(\exists!x : \ent) (0 \leq x < |escrutinio| - 1 \land_{L} ((\exists!y : \ent) (0 \leq y < |escrutinio| - 1 \land_{L} ((\forall i : \ent)(0 \leq i < |escrutinio| -1 \land \neg (i= x) \land  \neg(i = y) \longrightarrow_{L } escrutinio[i] < escrutinio[res_y] < escrutinio[res_x]))))}

            	\end{proc}
		
		\subsubsection{Predicados Especificos}
			

	


	 \subsection{calcularDHondtEnProvincia}
		\subsubsection{Main}
			\begin{proc}{calcularDHondtEnProvincia}{\In cant\_bancas: \ent, \In escrutinio: \TLista{\ent} } {\TLista{\TLista{\ent}}}
				 
				\requiere{eleccionValida(escrutinio) \land umbralElectoral(escrutinio) \land cant\_bancas>0)}
				\asegura{((\forall \: x:\ent)(0\leq n < cant\_bancas) \land_{L} (\forall \: x:\ent)(0\leq n <|escrutinio|))\longrightarrow_{L } \: (res[x][n]=\frac{escrutinio[x]}{n+1})}

			\end{proc}



	\subsection{obtenerDiputadosEnProvincia}
		\subsubsection{Main}
			\begin{proc}{obtenerDiputadosEnProvincia}{\In cant\_bancas: \ent, \In escrutinio: \TLista{\ent}, \In dHondt: \TLista{\TLista{\ent}}} {\TLista{\ent}}
				 
				\requiere{eleccionValida(escrutinio) \land umbralElectoral(escrutinio)}
				\asegura{(\forall \: r:\ent)(0\leq r < |escrutinio| - 1 \longrightarrow_{L} res[r] = bancasDe(r, cant\_bancas, dHondt))}
			\end{proc}

	
			\pred{cocienteGanador}{\In indicePartido: \ent, \In bancaEnDisputa: \ent, \In dHont: \TLista{\TLista{\ent}}}{res = True \longleftrightarrow
(\forall \: i: \ent)(0 \leq i < |dHont| -1 \land \neg(i = indicePartido) \longrightarrow_{L } dHont[bancaEnDisputa][indicePartido] > dHont[bancaEnDisputa][i])}






	\subsection{validarListasDiputadosEnProvincia}
		\subsubsection{Main}
			
			\begin{proc}{(\In cant\_bancas: \ent, \In listas: \TLista{\TLista{dni:\ent \times genero: \ent}}}{\bool}
			
				\requiere{(cant\_bancas>0) \: \land (dni>0) \: \land \:  (1\leq genero \geq 2)}
				\asegura{(\forall \: \: partido:\ent)(0\leq partido<|listas|) \longrightarrow_{L} (cantCandidatosCorrecta(cant\_bancas,\: listas[partido])\land altGenero(listas[partido])}			

			\end{proc}
		
		\subsubsection{Predicados Especificos}
		
			\pred{cantCandidatosCorrecta}{cant\_bancas: \ent, partido: \TLista{dni:\ent \times genero: \ent}}{cant\_bancas=|partido|}

			\pred{altGenero}{partido: \TLista{dni:\ent \times genero: \ent}}{(((\forall n: \ent)(n>0))\longrightarrow_{L} ( ((n\mod2=0)\longrightarrow_{L} (partido[n,1]=1)) \land_{L } ((n\mod2=1)\longrightarrow_{L} (partido[n,1]=2)) \lor_{L} ((n \mod 2 = 0) \longrightarrow_{L} (partido[n,1]=2 \land_{L} (n \mod 2=1) \longrightarrow_{L} partido[n,1]=1))}
	





	


\section{Implementaciones y demostraciones de correctitud}

	\subsection{Implementaciones}
		
		\subsubsection{hayBallotage}
		% Para hacer que quede todo en una misma linea, se puede usar minipage
			\begin{minipage}[t]{\textwidth}
				\begin{lstlisting}[caption={()},label=code:for]
					res := true
					tans := 0
					primero := 0
					segundo := 0
					i := 0
					suma := 0
					while (escrutinio.size() > i) do
						suma:= suma + escrutinio[i]
						i := i + 1
					endwhile
					i := 0
					while (escrutinio.size() > i) do
						escrutinio[i] := (escrutinio[i] * 100)/suma
						i := i + 1
					endwhile
					i := 0
					while (escrutinio.size() > i) do 
						if (segundo < escrutinio[i])
							segundo := escrutinio[i]
						else:
							skip
						endif
						if (primero < segundo)
							trans := primero
							primero := segundo
							segundo := trans
						else:
							skip
						endif
						i := i + 1
					endwhile
					if (primero > 45)
						res := false
					else
						if ((primero > 40) && (primero - segundo >= 10))
							res := false
						else
							skip
						endif
					endif

				\end{lstlisting}
			\end{minipage}

		\subsubsection{hayFraude}
			\begin{minipage}[t]{\textwidth}
				\begin{lstlisting}[caption={()},label=code:for]
						i := 0
						SumaSen := 0
						sumaDip := 0
						sumaPres := 0
						while (escrutinio_Presidente.size() > i) do
							sumaPres := sumaPres + escrutinio_Presidente[i]
							sumaDip := sumaDip + escrutinio_Diputados[i]
							sumaSen := sumaSen + escrutinio_Senadoresl[i]
							i := i + 1
						endwhile
						res := true
						if (sumaPres = sumaDip && sumaPres = sumaSen) then 
							res := false
						else:
							skip
						endif
				\end{lstlisting}
			\end{minipage}

		\subsubsection{obtenerSenadoresEnProvincia}
			\begin{minipage}[t]{\textwidth}
				\begin{lstlisting}[caption={()},label=code:for]
						trans := 0
						primero := 0
						segundo := 0
						i := 0
						while (escrutinio.size() > i) do
							if (escrutinio[segundo] < escrutinio[i])
								segundo := i
							else:
								skip
							endif
							if (escrutinio[primero] < escrutinio[segundo])
								trans := primero
								primero := segundo
								segundo :=  trans
							else:
								skip
							endif
							i := i + 1
						endwhile	
						res_{0}:= primero
                        res{1}:= segundo
				\end{lstlisting}
			\end{minipage}
	
		\subsubsection{validarListasDiputadosEnProvincia}
			\begin{minipage}[t]{\textwidth}
				\begin{lstlisting}[caption={()},label=code:for]
					res := true
					i := 0
					while (listas.size() > i) do
						if (listas[i].size() != cant_bancas) 
							res:= false
						else:
							skip
						endif
						i := i + 1
					endwhile
					i := 0
					j := 1
					while (listas.size() > i) do
						genero := listas[i][0][1]
						while (listas[i].size() > j) do
							if (listas[i][j][1] == genero) 
								res:=false
							else:
								genero := listas[i][j][1]
								j := j + 1
							endif
						endwhile
						i := i + 1
					endwhile
				\end{lstlisting}
			\end{minipage}
		

\end{document}
